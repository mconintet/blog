##Normal 命令

到目前为止我们已经学习了一些在 Vimscript 中非常有用的命令，但是你在日常情况下的普通模式中都干了什么？我们能不能通过某种方式在我们的脚本中使用那些我们编辑文本的知识？

答案是：“当然可以”。我们之前已经看过了 `normal` 命令，现在是时候回顾它并稍微再深入一点了。运行下面的命令：

```vim
:normal G
```

Vim 会将你的光标移动到当前文件的最后一行，就好像你在普通模式下按下了 `G`。现在运行下面的命令：

```vim
:normal ggdd
```

Vim 将会移动到文件的行首（`gg`）然后删除那一行（`dd`）。

`normal` 命令可以简单的接收一串按键序列并加装它们是在普通模式中被按下的。看起来非常简单。

##避免映射

运行下面的命令，将按键 `G` 映射到其他东西：

```vim
:nnoremap G dd
```

现在在普通模式下按下 `G` 将会删除一行。试试这个命令：

```vim
:normal G
```

Vim 将会删除当前行。`normal` 命令将会进入到已经存在的映射。 

这意味着我们需要一些类似 `nnoremap` 于 `nmap` 的东西，以适用于 `normal`，否则我们将不能使用到那些被用户覆盖掉的按键功能。

幸运的是 Vim 有一个 `normal!` 命令可以解决这个问题。运行这个命令：

```vim
:normal! G
```

这次 Vim 移动到了文件的底部，尽管 `G` 已经被我们覆盖了。

当在编写 Vim 脚本的时候，你应该**始终**使用 `normal!`，并且绝不到使用简单的 `normal`。你无法确定哪些按键已经被用户在他们的 `~/.vimrc` 文件中的映射覆盖了。

##特殊字符

如果你完了一段时间的 `normal!` 你会发现一个问题。试下下面的命令：

```vim
:normal! /foo<cr>
```

第一眼看上去好像是应该执行一个搜索，搜索 `foo`，但是你将发现这不能工作。问题就在于 `normal!` 没有解析特殊字符，比如 `<cr>`。

在这个例子中，Vim 认为你想到搜索这样的字符序列 ”f,o,o,小于号,c,r,大于号“，没有意识到你是要按下回车去执行一个搜索！我们下一节将会讨论如何绕过这个问题。

##练习

阅读 `:help normal`。其中的结尾部分将是下一节内容的暗示。

##额外加分项

如果你不喜欢挑战的话，跳过这个部分。如果你喜欢的话，祝你好运！

回顾一下 `:help normal` 中关于撤销操作的部分。试着去建立一个可以删除两行的映射，但是允许你一行一行的进行撤销操作。`nnoremap <leader>d dddd` 是一个好开端。

实际上对此你不需要 `normal!`（`nnoremap` 就足够了），但是这说明一个好处：有时在阅读 Vim 命令的时候，会发散到另一个不相干的有趣的事情上。

如果你还没有使用过 `helpgrep` 命令，那么你很可能将需要它。阅读 `:help helpgrep`。多试一试如何在匹配内容之前进行导航。

关于匹配模式目前不用担心，我将很快去了解它们。现在你已经可以使用类似 `foo.*bar` 的东西去在文档中进行正则匹配了。

不幸的是，`helpgrep` 有时会让人感到沮丧，因为在你进行搜索之前你得先知道你要找什么！在这个问题上我将帮助你，你需要找到一个手动的终止 Vim 撤销序列的方式，这样的话被删除的两行就可以分别的被撤销操作了。

以后，需要注意效率。当你遇到一个模糊的问题时，有时 Google 是更快更容易的。
