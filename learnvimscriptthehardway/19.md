##变量

目前为止我们已经介绍了单个命令。在这本书的接下来的三分之一中，我们将把 Vimscript 当做是编程语言去了解。这将可能不会像你已经学到的那些可以让你立刻看到成果，但是它是在为这本书的最后一部分做铺垫，从零开始开发一个成熟的 Vim 插件。

让我们开始。我们需要首先讨论的就是变量。运行下面的命令：

```vim
:let foo = "bar"
:echo foo
```

Vim 将会显示 `bar`。`foo` 现在是一个变量了，并且我们将它的值设置成了一个字符串：`"bar"`。现在运行下面的命令：

```vim
:let foo = 42
:echo foo
```

Vim 将会显示 `42`，因为我们将 `foo` 的值重新指定为 `42`。

从这两个简短的例子中我们似乎看出 Vimscript 是动态类型的。不是这样的，我们之后将会讨论。

##选项和变量

你可以通过一个特殊的语法去将选项作为变量去读取和设置。运行下面的命令：

```vim
:set textwidth=80
:echo &textwidth
```

Vim 将会显示 `80`。在一个名字的前面加上井号可以告诉 Vim 你正引用一个选项，而不是具有同样名称的变量。

让我们看看 Vim 对于布尔值选项如何工作。运行下面的命令：

```vim
:set nowrao
:echo &wrap
```

Vim 显示 `0`。现在试试下面的命令：

```vim
:set wrap
:echo &wrap

Vim 将显示 `1`。这强烈暗示了 Vim 将整型的 `0` 当做 ”假（false）“ 并且整型的 `1` 当做 ”真（true）“。可以非常合理的猜测 Vim 认为所有非零的整型都是”真的“，并且这的确是这样。

我们还可以使用 `let` 去将选项当成是变量进行设置。运行下面的命令：

```vim
:let &textwidth = 100
:set textwidth?
```

Vim 将会显示 `textwidth=100`。

在我们已经有了 `set` 的时候为什么还需要 `let`？运行下面的命令：

```vim
:let &textwidth = &textwidth + 10
:set textwidth?
```

这次 Vim 将会显示 `textwidth=110`。当你使用 `set` 去设置选项的时候你只能使用单个的字面值。当你使用 `let` 的时候你可以使用 Vimscript 的全部功能去分配值。

##本地选项

如果你希望以变量的方式，将选项设置成局部的而不是全局的，你需要在变量的前面加上前缀。

在独立的窗口分隔中打开两个文件。运行下面的命令：

```vim
:let &l:number = 1
```

现在切换到另一个文件并运行命令：

```vim
:let &l:number = 0
```

注意现在第一个窗口中有行号，而第二个没有。

##寄存器变量

你也可以将寄存器当做变量去进行读取和设置。运行下面的命令：

```vim
:let @a = "hello!"
```

现在将你的光标放到文本中的任意地方并按下 `"ap`，这个命令告诉 Vim ”将寄存器 `a` 中的内容粘贴到这里“。我们刚刚设置了那个寄存器，所以 Vim 将 `hello!` 粘贴到了文本中。

寄存器也可以被读取。运行下面的命令：

```vim
:echo @a
```

Vim 将会显示 `hello!`。

在你的文件中选择一个单词然后按下 `y` 去复制它，然后运行下面的命令：

```vim
:echo @"
```

Vim 将会输出你刚刚复制的值。寄存器 `"` 就是 ”未命名“ 寄存器，就是你在复制的时候没有指定目标的内容容器。

在文件中通过 `/someword` 去执行一个搜索，然后运行下面的命令：

```vim
:echo @/
```

Vim 将会输出你刚刚使用的搜索模式。这可以让你以编程的方式去读取和修改当前的搜索模式，有时会非常有用。

##练习

检查你的 `~/.vimrc` 文件并将命令的 `set` 和 `setlocal` 修改成它们的 `let` 形式。记住还需要给布尔值选项设置一些东西。

将一个布尔值选项比如 `wrap` 设置成一些不是零或者一的值。当你把它设置成一个不同的数字时发生了什么？如果设置成一个字符串呢？

检查你的 Vim `~/.vimrc` 并撤销刚刚的修改。如果 `let` 和 `set` 会使得代码变得难以阅读的话，就不要使用。

阅读 `:help registers` 并看看寄存器列表中哪些是你可以读写的。
