##有责任的编码

到目前为止我们已经接触了一堆 Vim 命令，你已经可以快速的自定义你的 Vim 了。它们中除了自动命令之外都是单行的，你可以在很短的时间内将其添加到你的 `~/.vimrc` 文件中。

在这本书的下一个部分中，我们将把 Vim 当成是一个真实的编程语言并投入其中，但是在那之前，我想关于如何在写大量的 Vimscript 的同事保持头脑清醒的问题上稍微讨论一下。

##注释

Vimscript 是非常强大的，但是许多年来它以变成一个狡猾的迷宫，并随时准备诱捕那些进入其中的粗心开发者。

选项和命令通常是扼要并难以阅读的，围绕兼容性问题会增加代码的复杂性。编写一个插件并允许用户对其自定义会在那之上引入另一个问题。

在写任何的稍微有点行数的 Vimscript 的时候需要保持戒备。添加一个注释去解释做了什么，并且如何有一个有用并相关的主题，也在注释中提及。

这样不光对你在几个月或是几年后再来维护自己的脚本有帮助，也对那些阅读你放置于 Bitbucket 或是 Github（强烈建议）上面的代码的人有帮助。

##分组

我们的为了编辑和应用 `~/.vimrc` 而创建的快捷键可以使得添加新的东西到配置文件中变得非常快速和轻松，并且保持当前工作的连贯性。不幸的是，这也会利于配置文件的失控和难以被驾驭。

一种与此抗衡的方法是使用 Vim 的代码折叠能力并将行进行分组。如果你还没有接触过 Vim 的代码折叠，你需要尽可能的浏览一下。一些人（包括我自己）发现它在日常编码中是必不可少的。

首先我们需要为 Vimscript 文件设置折叠。将下面的行添加到你的 `~/.vimrc` 文件中。

```vim
augroup filetype_vim
    autocmd!
    autocmd FileType vim setlocal foldmethod=marker
augroup END
```

这样会告诉 Vim 为你的 Vimscript 文件使用折叠方法中的 `marker`。

继续在你打开 `~/.vimrc` 文件的窗口中运行 `:setlocal foldmethod=marker`。应用配置文件是不会起效果的，因为 Vim 已经设置过文件类型了，而自动命令只有在当相应的事件发生时才起效果。以后你不会需要手动操作它。

现在在自动命令组之前和之后添加一些行使其看起来类似：

```vim
" Vimscript file settings ---------------------- {{{
augroup filetype_vim
    autocmd!
    autocmd FileType vim setlocal foldmethod=marker
augroup END
" }}}
```

回到普通模式，将你的光标放到上面中的任意行按下 `za`。Vim 将会折叠由 `{{{` 开始和由 `}}}` 结束之间的行。再次按下 `za` 将会展开那些行。

起初你会觉得在源码中添加注释是令人讨厌的。当我第一次看到这个的时候也是这么认为的。就现在针对大部分文件我还是这么认为。并不是所有人都是用同样的编辑器，所以将你的代码和折叠注释丢在一起，对于那些是用其他非 Vim 编辑器的人来说将是噪音。

可 Vimscript 文件是一个特例，对于不使用 Vim 的人将不太可能去阅读你的 Vimscript 代码，并且在写 Vimscript 的时候显式的将事情分组和仔细的思考，会使得你不会变疯。

试一试这些清晰的折叠，你会变得爱上它们。

##短名称

Vim 允许你为大部分的命令和选项是用其缩写。比如，下面的两个命令做了相同的事情：

```vim
:setlocal wrap
:setl wrap
```

我强烈建议你不要在 `~/.vimrc` 文件和你写的插件中使用缩写。Vimscript 是非常扼要和隐秘的；缩写将进一步使其难以阅读。即使你知道一个缩写命令的意思，那些读你代码的人可能并不知道。

这就表示，缩写是非常有用的，当你在编写代码的过程中手动运行命令时。当你按下回车之后，没人会再看到它们，所以没有必要敲更多的按键。

##练习

检查你的整个 `~/.vimrc` 文件并分组整理相关的行。一些可以着手的地方可能是：“基础设置（Basic Setting）”，“文件类型设置（FileType-specific settings）”，“（按键映射）Mappings"，和”状态行（Status Line）“。为每段都添加折叠标记。

找出如何去使得 Vim 在首次打开任何文件的时候都是自动折叠的。看看 `:help foldevelstart`，是一个好的切入点。

检查你的 `~/.vimrc` 找出所有的命令和选项的缩写并使用它们的全名称。

仔细检查你的 `~/.vimrc` 文件以确保其中没有你的敏感信息。创建一个 Git 或者 Mercurial 仓库，将配置文件移动到其中，并为 `~/.vimrc` 创建一个软连接。

提交你刚刚创建的仓库并将其放置到 Bitbucket 或者 Github，这样别人就能看到你的代码并从中获取他们需要的。确保经常性的提交并推送仓库，这样你的修改将会有迹可循。

如果你在不止一台机器上使用 Vim，克隆上面的仓库并为配置文件创建软连接。这将易于你在你所有工作的机器上都使用完全相同的配置。
